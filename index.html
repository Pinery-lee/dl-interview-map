<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>计算机视觉面试笔记 - 思维导图</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-elixir/dist/MindElixir.js"></script>
    <style>
        #map {
            height: 90vh;
            width: 100%;
        }

        .toolbar {
            height: 8vh;
            padding: 10px;
            background: #f4f4f4;
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>

<body>

    <div class="toolbar">
        <strong>CV 面试导图</strong>
        <button onclick="saveToLocal()">保存到本地浏览器</button>
        <button onclick="exportJSON()">导出 JSON 文件</button>
        <span style="font-size: 12px; color: #666;">(双击节点编辑，右键添加子节点)</span>
    </div>

    <div id="map"></div>

    <script>
        // 默认数据结构（你可以根据 CV 知识点自行扩展）
        const defaultData = {
            nodeData: {
                topic: '计算机视觉面试必备',
                id: 'root',
                root: true,
                children: [
                    {
                        topic: '传统图像处理',
                        id: 'trad',
                        children: [
                            { topic: 'Canny 边缘检测', id: 'canny' },
                            { topic: 'HOG 特征提取', id: 'hog' }
                        ]
                    },
                    {
                        topic: '深度学习基础',
                        id: 'dl',
                        children: [
                            { topic: '卷积层原理', id: 'conv' },
                            { topic: '激活函数 (ReLU, Softmax)', id: 'act' }
                        ]
                    },
                    {
                        topic: '目标检测',
                        id: 'det',
                        children: [
                            { topic: 'YOLO 系列', id: 'yolo' },
                            { topic: '损失函数: $IoU = \frac{A \cap B}{A \cup B}$', id: 'iou' }
                        ]
                    }
                ]
            }
        };

        // 初始化思维导图
        let mind = new MindElixir({
            el: '#map',
            direction: MindElixir.SIDE,
            data: JSON.parse(localStorage.getItem('cv_mind_data')) || defaultData,
            draggable: true,
            contextMenu: true,
            toolBar: true,
            nodeMenu: true,
            keypress: true,
        });
        mind.init();

        // 保存到浏览器的 localStorage
        function saveToLocal() {
            const data = mind.getAllData();
            localStorage.setItem('cv_mind_data', JSON.stringify(data));
            alert('已保存到浏览器缓存！刷新页面也不会丢失。');
        }

        // 导出 JSON 方便你更新 GitHub 仓库里的初始值
        function exportJSON() {
            const data = mind.getAllData();
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "cv_mindmap.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }
    </script>
</body>

</html>